(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[365],{3588:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var a=s(5155),r=s(2115),n=s(5695),o=s(9505),i=s.n(o),l=s(7832);function c(e){let{setForm:t}=e,[s,o]=(0,r.useState)(""),[c,u]=(0,r.useState)(""),g=(0,n.useRouter)(),h=async()=>{try{(await (0,l.iD)({username:s,password:c})).success?(localStorage.setItem("username",s),g.push("/dashboard")):alert("Login failed")}catch(e){console.error("Login error:",e),alert("Login error occurred")}};return(0,a.jsxs)("div",{className:i().form,children:[(0,a.jsx)("input",{placeholder:"Username",className:i().input,value:s,onChange:e=>o(e.target.value)}),(0,a.jsx)("input",{placeholder:"Password",type:"password",className:i().input,value:c,onChange:e=>u(e.target.value)}),(0,a.jsx)("button",{className:i().button,onClick:h,children:"Login"}),(0,a.jsxs)("p",{className:i().switch,children:["Don't have an account?"," ",(0,a.jsx)("span",{className:i().link,onClick:()=>t("register"),children:"Register"})]})]})}var u=s(7529),g=s.n(u);function h(e){let{setForm:t}=e,[s,n]=(0,r.useState)(""),[o,i]=(0,r.useState)(""),[c,u]=(0,r.useState)(""),[h,d]=(0,r.useState)(""),_=async()=>{try{let e=await (0,l.kz)({username:s,password:o,privateKey:c,publicKey:h});e.success?(alert("Registered successfully!"),t("login")):alert("Registration failed: "+e.result)}catch(e){console.error("Register error:",e),alert("An error occurred during registration")}};return(0,a.jsxs)("div",{className:g().form,children:[(0,a.jsx)("input",{placeholder:"Username",className:g().input,value:s,onChange:e=>n(e.target.value)}),(0,a.jsx)("input",{placeholder:"Password",type:"password",className:g().input,value:o,onChange:e=>i(e.target.value)}),(0,a.jsx)("textarea",{placeholder:"Private key (base64)",className:g().textarea,value:c,onChange:e=>u(e.target.value),rows:4}),(0,a.jsx)("textarea",{placeholder:"Public key (base64)",className:g().textarea,value:h,onChange:e=>d(e.target.value),rows:4}),(0,a.jsx)("button",{className:g().button,onClick:_,children:"Register"}),(0,a.jsxs)("p",{className:g().switch,children:["Already have an account?"," ",(0,a.jsx)("span",{className:g().link,onClick:()=>t("login"),children:"Login"})]})]})}var d=s(6447),_=s.n(d);function m(){let[e,t]=(0,r.useState)("login"),s=(0,n.useRouter)();return(0,a.jsx)("div",{className:_().page,children:(0,a.jsxs)("main",{className:_().container,children:[(0,a.jsx)("h1",{className:_().title,children:"Welcome"}),(0,a.jsx)("button",{className:_().guestButton,onClick:()=>{localStorage.removeItem("username"),document.cookie="uuid=; Max-Age=0; path=/",s.push("/dashboard")},children:"Continue as Guest"}),(0,a.jsx)("h2",{className:_().subtitle,children:"login"===e?"Login to your account":"Create a new account"}),"login"===e?(0,a.jsx)(c,{setForm:t}):(0,a.jsx)(h,{setForm:t})]})})}},5695:(e,t,s)=>{"use strict";var a=s(8999);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},6447:e=>{e.exports={page:"AuthPage_page__7yF0o",gradientFlow:"AuthPage_gradientFlow__TgcPs",container:"AuthPage_container__kSOoZ",title:"AuthPage_title__k5Lsa",subtitle:"AuthPage_subtitle__adf33",guestButton:"AuthPage_guestButton__SMZUO"}},6892:(e,t,s)=>{Promise.resolve().then(s.bind(s,3588))},7529:e=>{e.exports={form:"RegisterForm_form__Alfsv",input:"RegisterForm_input__BX8gj",button:"RegisterForm_button__DUUu3",switch:"RegisterForm_switch__lfNHu",link:"RegisterForm_link__2Ufjn",textarea:"RegisterForm_textarea__rNofQ"}},7832:(e,t,s)=>{"use strict";s.d(t,{Mw:()=>r,TO:()=>a,_z:()=>o,cC:()=>n,iD:()=>i,kz:()=>l});let a=()=>{var e;return null!=(e=localStorage.getItem("username"))?e:"guest"},r=async()=>{try{let e=await fetch("/anon/getMessages"),t=await e.json();return console.log("public",t),t}catch(e){throw console.error("❌ getPublicMessages error:",e),e}},n=async()=>{let e=await fetch("/api/getMessages",{credentials:"include"}),t=await e.json();return console.log("private",t),t},o=async e=>{let{to:t,message:s,shouldBeEncrypted:a=!1}=e,r=await fetch("/api/addRecord",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({to:t,message:s,shouldBeEncrypted:a})});return console.log("\uD83D\uDCE4 Send message status:",r.status),r.json()},i=async e=>{let{username:t,password:s}=e,a=await fetch("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:t,password:s})});console.log("\uD83D\uDD01 Login response status:",a.status);let r=await a.json();return console.log("✅ Login response:",r),r},l=async e=>{let{username:t,password:s,privateKey:a,publicKey:r}=e,n=await fetch("/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:s,privateKey:a,publicKey:r})});return console.log("\uD83D\uDCDD Register response status:",n.status),n.json()}},9505:e=>{e.exports={form:"LoginForm_form__a1265",input:"LoginForm_input__E4vWR",button:"LoginForm_button__HzBCb",switch:"LoginForm_switch__rkf6L",link:"LoginForm_link__RRXam"}}},e=>{var t=t=>e(e.s=t);e.O(0,[750,441,684,358],()=>t(6892)),_N_E=e.O()}]);