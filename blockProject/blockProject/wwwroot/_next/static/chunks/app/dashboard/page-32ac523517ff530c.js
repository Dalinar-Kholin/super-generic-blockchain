(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{353:e=>{e.exports={wrapper:"PublicMessages_wrapper__5vy0Q",list:"PublicMessages_list__1_S1S",item:"PublicMessages_item__F2IEE",meta:"PublicMessages_meta__HZlEa",from:"PublicMessages_from__4zztK",to:"PublicMessages_to__3yZ6M",text:"PublicMessages_text__7L5GI"}},705:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>v});var t=a(5155),r=a(2115);let l=()=>{var e;return null!=(e=localStorage.getItem("username"))?e:"guest"},c=async()=>{try{let e=await fetch("/anon/getMessages"),s=await e.json();return console.log("public",s),s}catch(e){throw console.error("❌ getPublicMessages error:",e),e}},n=async()=>{let e=await fetch("/api/getMessages",{credentials:"include"}),s=await e.json();return console.log("private",s),s};var i=a(353),o=a.n(i);function _(){let[e,s]=(0,r.useState)([]);return(0,r.useEffect)(()=>{(async()=>{try{var e;let a=await c();s(null!=(e=a.result)?e:[])}catch(e){console.error("❌ Failed to fetch public messages:",e)}})()},[]),(0,t.jsx)("div",{className:o().wrapper,children:(0,t.jsx)("ul",{className:o().list,children:e.map((e,s)=>(0,t.jsxs)("li",{className:o().item,children:[(0,t.jsxs)("div",{className:o().meta,children:[(0,t.jsx)("span",{className:o().from,children:e.from}),(0,t.jsxs)("span",{className:o().to,children:["→ ",e.to]})]}),(0,t.jsx)("div",{className:o().text,children:e.message})]},s))})})}var d=a(3417),u=a.n(d);function h(){let[e,s]=(0,r.useState)([]);return(0,r.useEffect)(()=>{(async()=>{try{var e;let a=await n();s(null!=(e=a.result)?e:[])}catch(e){console.error("❌ Failed to fetch private messages:",e)}})()},[]),(0,t.jsx)("div",{className:u().wrapper,children:(0,t.jsx)("ul",{className:u().list,children:e.map((e,s)=>(0,t.jsxs)("li",{className:u().item,children:[(0,t.jsxs)("div",{className:u().meta,children:[(0,t.jsx)("span",{className:u().from,children:e.from}),(0,t.jsxs)("span",{className:u().to,children:["→ ",e.to]})]}),(0,t.jsx)("div",{className:u().text,children:e.message})]},s))})})}var m=a(4793),g=a.n(m);function x(){let[e,s]=(0,r.useState)("0x0"),[a,l]=(0,r.useState)(""),[c,n]=(0,r.useState)(!1),[i,o]=(0,r.useState)(null),_=async()=>{o("sending…");try{let s=await fetch("http://127.0.0.1:8071/api/addRecord",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({to:e,message:a,shouldBeEncrypted:c})}),t=await s.json();o(t.success?"sent ✅":"error: "+t.result),l("")}catch(e){o("network error")}};return(0,t.jsxs)("div",{className:g().form,children:[(0,t.jsx)("input",{value:e,onChange:e=>s(e.target.value),className:g().input,placeholder:"Recipient (address)"}),(0,t.jsx)("textarea",{value:a,onChange:e=>l(e.target.value),className:g().textarea,rows:3,placeholder:"Your message"}),(0,t.jsxs)("label",{className:g().chk,children:[(0,t.jsx)("input",{type:"checkbox",checked:c,onChange:e=>n(e.target.checked)}),"encrypt"]}),(0,t.jsx)("button",{className:g().button,onClick:_,children:"Send"}),i&&(0,t.jsx)("p",{className:g().status,children:i})]})}var p=a(5333),j=a.n(p);function v(){let[e,s]=(0,r.useState)("guest");(0,r.useEffect)(()=>{s(l())},[]);let a="guest"===e;return(0,t.jsx)("div",{className:j().page,children:(0,t.jsxs)("div",{className:j().card,children:[(0,t.jsxs)("header",{className:j().header,children:["hello,\xa0",(0,t.jsx)("strong",{children:e})]}),(0,t.jsxs)("section",{className:j().section,children:[(0,t.jsx)("h3",{children:"\uD83C\uDF10 Public messages"}),(0,t.jsx)(_,{})]}),a?(0,t.jsx)("p",{className:j().note,children:"Log in to view private inbox & send messages"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("section",{className:j().section,children:[(0,t.jsx)("h3",{children:"\uD83D\uDD12 Your private messages"}),(0,t.jsx)(h,{})]}),(0,t.jsxs)("section",{className:j().section,children:[(0,t.jsx)("h3",{children:"✉️ Send a message"}),(0,t.jsx)(x,{})]})]})]})})}},1058:(e,s,a)=>{Promise.resolve().then(a.bind(a,705))},3417:e=>{e.exports={wrapper:"PrivateMessages_wrapper__Nu_gF",list:"PrivateMessages_list__Ubth1",item:"PrivateMessages_item__AgXG9",meta:"PrivateMessages_meta__QVxX1",from:"PrivateMessages_from__yfd4D",to:"PrivateMessages_to__QY5rz",text:"PrivateMessages_text__A9Ot3"}},4793:e=>{e.exports={form:"SendMessageForm_form__98e_4",input:"SendMessageForm_input__guEGA",textarea:"SendMessageForm_textarea__suTvA",chk:"SendMessageForm_chk__BsjYc",button:"SendMessageForm_button__ZHoAh",status:"SendMessageForm_status__aWQf7"}},5333:e=>{e.exports={page:"DashboardPage_page__VBY6I",flow:"DashboardPage_flow__4_bv4",card:"DashboardPage_card__CGhWH",header:"DashboardPage_header__lKhIz",section:"DashboardPage_section__cWM8F",note:"DashboardPage_note__Y3QKr",loader:"DashboardPage_loader__UfjZf"}}},e=>{var s=s=>e(e.s=s);e.O(0,[729,441,684,358],()=>s(1058)),_N_E=e.O()}]);